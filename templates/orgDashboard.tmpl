{{ define "orgDashboard" }}
{{ template "part_header" . }}

<style type="text/css">
	#dashboard td{
		text-align: center;
	}
	#dashboard td {
		opacity: 0.5;
	}
	#dashboard td.success {
		border: 2px solid green;
		opacity: 1;
	}
</style>

<a href="teams" style="float: right;"><button class="btn btn-default">Teams</button></a>

<h1>Dashboard</h1>
{{ template "part_messageBox" . }}

<div style="max-width: 400px; padding: 10px; background-color: #eeeeee; border: 1px #dddddd solid; border-radius: 5px;">
<form method="post">
	<input type="submit" class="btn btn-primary btn-block" onclick="return confirm('Ukončit kolo?');" name="calculateRound" value="Ukončit kolo">
</form>
<form method="post" style="margin-top: 4px;">
	<input type="submit" class="btn btn-danger btn-block" onclick="return confirm('Pozot! Toto vymaže všechny kola, pokračovat?');" name="resetGame" value="Resetovat hru">
</form>
</div>

{{$allActions := .AllActions}}

<h2>Historie kol</h2>

<table class="table table-bordered" id="history">
<thead>
	<tr><th rowspan='2'>Kolo</th><th rowspan='2'>Stav</th><th colspan="{{len .Teams}}">Peníze a akce</th></tr>
	<tr>{{range .Teams}}<th colspan="2">{{.}}</th>{{end}}</tr>
</thead>
<tbody>
	<tr class="info"><th>NOW</th><td>{{.CurrentState}}</td>
		{{range .CurrentActions}}<td></td><td>{{(index $allActions .).DisplayName}}</td>{{end}}
	</tr>
	{{range .History}}
		<tr><th>{{.RoundNumber}}</th><td>{{.StartState}} -> {{.FinalState}}</td>
			{{range .Teams}}
				<td>{{if .Found}}{{.StartMoney}} -> {{.FinalMoney}}{{end}}</td>
				<td>{{if .Message}}<span title="{{.Message}}" style="border-bottom: 1px dotted;">{{else}}<span>{{end}}{{(index $allActions .Action).DisplayName}}</span></td>
			{{end}}
		</tr>
	{{end}}
</tbody>
</table>


</tbody>
</table>
{{ end }}
